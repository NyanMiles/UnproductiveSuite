<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>NFC Demo</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    button { margin: 10px; padding: 10px 20px; font-size: 16px; }
    #log { margin-top: 20px; white-space: pre-line; }
  </style>
</head>
<body>
  <h1>NFC en la Web ğŸš€</h1>

  <button id="scanButton">ğŸ“¡ Leer NFC</button>
  <button id="writeButton">âœï¸ Escribir NFC</button>
  <!-- <button id="makeReadOnlyButton">ğŸ”’ Hacer solo lectura</button> -->

  <div id="log"></div>

  <script>
    const logDiv = document.getElementById("log");
    function log(message) {
      logDiv.textContent += message + "\n";
    }

    const scanButton = document.getElementById("scanButton");
    const writeButton = document.getElementById("writeButton");
    // const makeReadOnlyButton = document.getElementById("makeReadOnlyButton");

    scanButton.addEventListener("click", async () => {
      log("User clicked scan button");

      try {
        const ndef = new NDEFReader();
        await ndef.scan();
        log("> Scan started");

        ndef.addEventListener("readingerror", () => {
          log("Argh! Cannot read data from the NFC tag. Try another one?");
        });

        ndef.addEventListener("reading", ({ message, serialNumber }) => {
          log(`> Serial Number: ${serialNumber}`);
          log(`> Records: (${message.records.length})`);
          for (const record of message.records) {
            log(`>> Record type: ${record.recordType}`);
            log(`>> Data: ${new TextDecoder().decode(record.data)}`);
          }
        });
      } catch (error) {
        log("Argh! " + error);
      }
    });

    writeButton.addEventListener("click", async () => {
      log("User clicked write button");

      try {
        const ndef = new NDEFReader();
        await ndef.write("Hello world!");
        log("> Message written");
      } catch (error) {
        log("Argh! " + error);
      }
    });

    /*
    makeReadOnlyButton.addEventListener("click", async () => {
      log("User clicked make read-only button");

      try {
        const ndef = new NDEFReader();
        await ndef.makeReadOnly();
        log("> NFC tag has been made permanently read-only");
      } catch (error) {
        log("Argh! " + error);
      }
    });
    */
  </script>
</body>
</html>